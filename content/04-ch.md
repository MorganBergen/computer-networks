#  chapter
##  network layer:  data plane

###  roadmap

-  network layer overview
    +  data plane
    +  control plane
-  what's inside a router
    +  input ports, switching, output ports
    +  buffer management, scheduling
-  ip:  the internet protocol
    +  datagram format
    +  addressing
    +  network address translation
    +  ipv6
-  generalized forwarding, sdn
    +  match + action
    +  openflow:  match + action in action
-  middleboxes

###  data plane our goals

###  network layer services and protocols

-  transport segment from sending to receiving host
    +  sender:  encapsulates segments into datagrams, passes to link layer
    +  receiver:  delivers segments to transport layer protocol

###  two key network-layer functions

**network-layer functions**
-  forwarding:  move packets from a router's input link to a router's input link to the appropriate router output link
-  routing:  determine route taken by packets from source to destination
    +  routing algorithms

**analogy:  taking a trip**
-  forwarding:  process of getting through a single interchange
-  routing:  process of planning a trip from source to destination

###  network layer:  data plane, control plane

###  per-router control plane

###  software defined networking sdn control plane

###  network service model

**question**:  what service model for channel transporting datagrams from sender to receiver?

###  network-layer service model

###  reflections on best-effort service

###  router architecture overview

###  input port functions

###  destination-based forwarding

###  longest prefix matching

###  switching fabric

###  switching via memory

###  switching via a bus

###  switching via interconnection network

###  input port queuing

###  output port queuing

###  buffer management

###  packet scheduling:  first come first served

###  scheduling policies:  priority scheduling

###  scheduling policies:  round robin

###  scheduling policies:  weighted fair queuing

###  network layer:  internet

-  host, router network layer functions
-  path-selection algorithms:  implemented in routing protocols (ospf, bgp) and sdn controller
-  forwarding table
-  ip protocol
    +  datagram format
    +  addressing
    +  packet handling conventions
-  icmp protocl
    +  error reporting
    +  router signaling

###  ip datagram format

```
<---------------------- 32 bits ------------------------>
+-------------------------------------------------------+
| version | head length | type of service | length      |
+-------------------------------------------------------+
| 16-bit identifier     | flags | fragment offset       |
+-------------------------------------------------------+
| time to live | upper layer | header checksum          |
+-------------------------------------------------------+
| source ip address                                     |
+-------------------------------------------------------+
| destination ip address                                |
+-------------------------------------------------------+
| options (if any)                                      |
+-------------------------------------------------------+
| payload data                                          |
| variable length                                       |
| typically a tcp or udp segment                        |
+-------------------------------------------------------+
```

-  `version`:  ip protocol version number
-  `head length`:  header length in bytes
-  `length`:  total datagram length in bytes
-  `type of service`:  type of service (e.d. diffserv, ecn)
-  `16-bit identifier`, `flags`, `fragment offset`:  used in fragmentation/reassembly
-  `time to live`:  ttl remaining max hops decremented at each router
-  `upper layer`:  upper layer protocol (e.g. tcp or udp)
-  `header checksum`:  checksum of header only
-  `source ip address`:  32-bit source ip address
-  `destination ip address`:  32-bit destination ip address
-  `options`:  timestamp, record route taken
-  `payload data`:  data being carried by the datagram, actual message being sent

###  ip addressing:  introduction 

-  ip address:  32-bit identifier associated with each host or router interface
-  interface:  connection between host/router and physical link
    +  router's typically have multiple interfaces
    +  host typically has one or two interfaces (e.g. wired ethernet, wireless 802.11)

question:  how are interfaces actually connected

answer:  wired ethernet interfaces connected by ethernet switches or wireless interfaces connected by wifi base station

###  subnets

-  what's a subnet
    +  device interfaces that can physically reach each other without passing through an intervening router

###  ip addressing:  cidr

###  ip addresses:  how to get one?

###  dhcp:  hynamic host configuration protocol

###  dhcp client-server scenario

###  dhcp:  more than ip addresses

###  ip address: how to get one?

###  hierarchical addressing:  route aggregation

###  hierarchical addressing:  more specific routes

###  ip addressing:  last words































































